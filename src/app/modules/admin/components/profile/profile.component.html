<h1 style="text-align: center">Administrador de pagos</h1>

<mat-accordion *ngFor="let trainer of trainers">
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>{{ trainer }}</mat-panel-title>
    </mat-expansion-panel-header>
    <p>Informacion de {{ trainer }}</p>
    <button mat-raised-button color="primary" (click)="exportToExcel(trainer)">
      Descargar Excel
    </button>

    <!-- Mat-Accordion anidado -->
    <mat-accordion>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Clientes por fecha y estatus</mat-panel-title>
        </mat-expansion-panel-header>
        <table
          mat-table
          [dataSource]="transformClientCountsToTableData(trainer)"
          matSort
          class="mat-table"
        >
          <!-- Columna de fecha -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.date }}
            </td>
          </ng-container>
          <!-- Columna de quincena -->
          <ng-container matColumnDef="fortNight">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Quincena</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.fortNight }}
            </td>
          </ng-container>
          <!-- Columna de numero de clientes de 3 dias A-->
          <ng-container matColumnDef="threeDaysActives">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Activos 3 dias
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.threeDaysActives ? summary?.threeDaysActives : "0" }}
            </td>
          </ng-container>
          <!-- Columna de numero de clientes de 3 dias P-->
          <ng-container matColumnDef="threeDaysPending">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Pendientes 3 dias
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.threeDaysPending ? summary?.threeDaysPending : "0" }}
            </td>
          </ng-container>
          <!-- Columna de numero de clientes de 6 dias A-->
          <ng-container matColumnDef="sixDaysActives">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Activos 6 dias
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.sixDaysActives ? summary?.sixDaysActives : "0" }}
            </td>
          </ng-container>
          <!-- Columna de numero de clientes de 6 dias P-->
          <ng-container matColumnDef="sixDaysPending">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Pendientes 6 dias
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.sixDaysPending ? summary?.sixDaysPending : "0" }}
            </td>
          </ng-container>
          <!-- Encabezados y Celdas -->
          <tr mat-header-row *matHeaderRowDef="clientsCountColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: clientsCountColumns"></tr>
        </table>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Contabilidad</mat-panel-title>
        </mat-expansion-panel-header>
        <table
          mat-table
          [dataSource]="transformClientAccountsToTableData(trainer)"
          matSort
          class="mat-table"
        >
          <!-- Columna de fecha -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.date }}
            </td>
          </ng-container>
          <!-- Columna de quincena -->
          <ng-container matColumnDef="fortNight">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Quincena</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.fortNight }}
            </td>
          </ng-container>
          <!-- Columna de ingreso bruto reportado-->
          <ng-container matColumnDef="grossIncomeReported">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Ingreso bruto reportado
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.grossIncomeReported | currency }}
            </td>
          </ng-container>
          <!-- Columna de pendiente por reportar-->
          <ng-container matColumnDef="pendingToReport">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Pendiente por reportar
            </th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.pendingToReport | currency }}
            </td>
          </ng-container>
          <!-- Columna de bono-->
          <ng-container matColumnDef="bonus">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Bono</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.bonus | currency }}
            </td>
          </ng-container>
          <!-- Columna de pago-->
          <ng-container matColumnDef="toPay">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Por pagar</th>
            <td mat-cell *matCellDef="let summary">
              <span class="status-circle"></span>
              {{ summary?.toPay | currency }}
            </td>
          </ng-container>
          <!-- Encabezados y Celdas -->
          <tr mat-header-row *matHeaderRowDef="clientsAccountsColumns"></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: clientsAccountsColumns"
          ></tr>
        </table>
      </mat-expansion-panel>
    </mat-accordion>
  </mat-expansion-panel>
</mat-accordion>
